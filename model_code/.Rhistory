# libraries
# install.packages('R.utils')
library(R.utils)
# load necessary functions
sourceDirectory('functions', modifiedOnly = FALSE)
elevation_m = 0
ca_ppm = 420
temperature_c = 25
# libraries
# install.packages('R.utils')
library(R.utils)
# load necessary functions
sourceDirectory('functions', modifiedOnly = FALSE)
patm_pa <- calc_patm(elevation_m)
ca_pa <- ca_ppm * 1e-6 * patm_pa
ci_pa <- 0.7 * ca_pa
gammastar_pa <- calc_gammastar_pa(temperature_c, elevation_m)
km_pa <- calc_km_pa(temperature_c, elevation_m)
mc = (ci_pa - gammastar_pa) / (ci_pa + km_pa)
ac = vcmax * mc # rubisco-limited photosynthesis
vcmax = 100
ac = vcmax * mc # rubisco-limited photosynthesis
ac
m = (ci_pa - gammastar_pa) / (ci_pa + 2 * gammastar_pa)
m
c = 0.05336251
e_partitioning_coef = 4
absorbance = 0.85
photosystem_partitioning_coef = 0.5
theta = 0.85
m <- (ci_pa - gammastar_pa) / (ci_pa + 2 * gammastar_pa)
omega <- calc_omega(theta = theta, c = c, m = m)
# load necessary functions
sourceDirectory('functions', modifiedOnly = FALSE)
omega <- calc_omega(theta = theta, c = c, m = m)
omega_star <- (1 + (omega) - sqrt((1 + (omega))^2 - (4 * theta * omega)))
j <- (phi_psii * par * absorbance * photosystem_partitioning_coef * omega_star) / theta
aj <- (j/e_partitioning_coef) * m # rubp regeneration-limited photosyntehsis
phi_psii = 0.2
j <- (phi_psii * par * absorbance * photosystem_partitioning_coef * omega_star) / theta
par = 800
j <- (phi_psii * par * absorbance * photosystem_partitioning_coef * omega_star) / theta
aj <- (j/e_partitioning_coef) * m # rubp regeneration-limited photosyntehsis
aj
?sqrt
phi_psii = 0.2
e_partitioning_coef = 4
absorbance = 0.85
photosystem_partitioning_coef = 0.5
theta = 0.85
m <- (ci_pa - gammastar_pa) / (ci_pa + 2 * gammastar_pa)
j_a <- theta
j_a
j_b <- -(phi_psii * absorbance * photosystem_partitioning_coef * par + jmax)
j_c <- phi_psii * absorbance * photosystem_partitioning_coef * par * jmax
jmax = 200
j_b <- -(phi_psii * absorbance * photosystem_partitioning_coef * par + jmax)
j_c <- phi_psii * absorbance * photosystem_partitioning_coef * par * jmax
j_b
j_c
j <- (-j_b + sqrt(j_b^2 - 4 * j_a * j_c)) / (2 * j_a)
j
aj <- (j/e_partitioning_coef) * m # rubp regeneration-limited photosyntehsis
aj
a <- pmin(ac, aj)
a
photosynthesis_model <- function(elevation_m = 0, ca_ppm = 420, temperature_c = 25, par = 800,
vcmax = 100, jmax = 200,
phi_psii = 0.2,
e_partitioning_coef = 4,
absorbance = 0.85,
photosystem_partitioning_coef = 0.5,
theta = 0.85){
patm_pa <- calc_patm(elevation_m) # atmospheric pressure (Pa)
ca_pa <- ca_ppm * 1e-6 * patm_pa # atmospheric co2 (Pa)
ci_pa <- 0.7 * ca_pa # intercellular co2 (Pa)
gammastar_pa <- calc_gammastar_pa(temperature_c, elevation_m) # co2 compensation point (Pa)
km_pa <- calc_km_pa(temperature_c, elevation_m) # michaelis-menten coefficient for rubisco (Pa)
mc = (ci_pa - gammastar_pa) / (ci_pa + km_pa) #
ac = vcmax * mc # rubisco-limited photosynthesis
m <- (ci_pa - gammastar_pa) / (ci_pa + 2 * gammastar_pa)
j_a <- theta
j_b <- -(phi_psii * absorbance * photosystem_partitioning_coef * par + jmax)
j_c <- phi_psii * absorbance * photosystem_partitioning_coef * par * jmax
j <- (-j_b + sqrt(j_b^2 - 4 * j_a * j_c)) / (2 * j_a)
aj <- (j/e_partitioning_coef) * m # rubp regeneration-limited photosyntehsis
a <- pmin(ac, aj)
}
# load up model and functions
source(photosynthesis_model.R)
# load up model and functions
source('photosynthesis_model.R')
co2_response <- photosynthesis_model(ca_ppm = seq(200, 1000, 50))
co2_response <- photosynthesis_model(ca_ppm = seq(200, 2000, 50))
co2_response
## load up model and functions
source('photosynthesis_model.R')
co2_response <- photosynthesis_model(ca_ppm = seq(200, 2000, 50))
co2_response
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom(line, width = 2)
library(ggplot2)
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom(line, width = 2)
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', width = 2)
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', width = 4) +
6
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', width = 4) +
geom_line(col = 'red', width = 4, lty = 3, aes(y = aj))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 4) +
geom_line(col = 'red', size = 4, lty = 3, aes(y = aj))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 3, aes(y = aj))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 3, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 3, aes(y = ac))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
light_response <- photosynthesis_model(par = seq(0, 2000, 50))
ggplot(data = co2_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 2000, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 2000, 50), jmax = 150)
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 2000, 50), jmax = 100)
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
## load up model and functions
source('photosynthesis_model.R')
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5))
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
0.352 +(0.022*25) - (0.00034*25*25)
## load up model and functions
source('photosynthesis_model.R')
co2_response <- photosynthesis_model(ca_ppm = seq(200, 2000, 50))
co2_response
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 2000, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 1000, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5))
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes")
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
## load up model and functions
source('photosynthesis_model.R')
co2_response <- photosynthesis_model(ca_ppm = seq(200, 2000, 50))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 1000, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes")
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 500, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes")
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response2 <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "no")
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
## libraries
# install.packages('R.utils')
library(R.utils)
library(ggplot2)
## load up model and functions
source('photosynthesis_model.R')
co2_response <- photosynthesis_model(ca_ppm = seq(200, 2000, 50))
ggplot(data = co2_response, aes(x = ca_ppm, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
par_response <- photosynthesis_model(par = seq(0, 500, 50))
ggplot(data = par_response, aes(x = par, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes")
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes",
par = 200)
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response2 <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "no",
par = 200)
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes",
par = 100)
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response2 <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "no",
par = 100)
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "yes",
par = 200)
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response2 <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "no",
par = 200)
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "bernacchi",
par = 500)
ggplot(data = temperature_response, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
temperature_response2 <- photosynthesis_model(temperature_c = seq(0, 50, 5), phi_psii_tresp = "no",
par = 500)
ggplot(data = temperature_response2, aes(x = temperature_c, y = a)) +
geom_line(col = 'black', size = 2) +
geom_line(col = 'red', size = 2, lty = 2, aes(y = aj)) +
geom_line(col = 'blue', size = 2, lty = 2, aes(y = ac))
